--// ExperienceGui Loader
--// Made by CoolDown
--// Password = CoolDownExperience
--// Changes = script library fixed

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- Load Rayfield
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

-- Main Window
local Window = Rayfield:CreateWindow({
    Name = "ExperienceGui",
    LoadingTitle = "ExperienceGui",
    LoadingSubtitle = "Made by CoolDown",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "ExperienceGui",
        FileName = "Config"
    },
    Discord = {
        Enabled = false
    },
    KeySystem = true,
    KeySettings = {
        Title = "ExperienceGui Access",
        Subtitle = "Enter Password",
        Note = "Password required to continue",
        FileName = "ExperienceKey",
        SaveKey = false,
        GrabKeyFromSite = false,
        Key = {"CoolDownExperience"} -- ✅ static password
    }
})

-- Tabs
local HomeTab = Window:CreateTab("Home", 4483362458)
local NeedsTab = Window:CreateTab("Basic Needs", 4483362458)
local ScriptsTab = Window:CreateTab("Script Library", 4483362458)

-- Home / Info
HomeTab:CreateLabel("Welcome to ExperienceGui")
HomeTab:CreateLabel("Made by CoolDown")
HomeTab:CreateLabel("Client: " .. LocalPlayer.Name)

-- Basic Needs
NeedsTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 200},
    Increment = 1,
    Suffix = " speed",
    CurrentValue = 16,
    Flag = "WalkSpeed",
    Callback = function(Value)
        LocalPlayer.Character.Humanoid.WalkSpeed = Value
    end,
})

NeedsTab:CreateSlider({
    Name = "JumpPower",
    Range = {50, 300},
    Increment = 5,
    Suffix = " power",
    CurrentValue = 50,
    Flag = "JumpPower",
    Callback = function(Value)
        LocalPlayer.Character.Humanoid.JumpPower = Value
    end,
})

NeedsTab:CreateButton({
    Name = "Enable Fly",
    Callback = function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt"))()
    end,
})

-- Autorun script (after password unlock)
task.defer(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/VapeVoidware/VW-Add/main/loader.lua", true))()
end)

-- Script Library
local function LoadScripts()
    local success, result = pcall(function()
        -- Use proper raw GitHub URL
        return game:HttpGet("https://raw.githubusercontent.com/ARandomDumDev/ExperienceGui/main/Scripts.txt")
    end)

    if not success then
        ScriptsTab:CreateLabel("⚠️ Failed to load Scripts.txt")
        return
    end

    local scripts = {}
    local decodeSuccess, decodeResult = pcall(function()
        return HttpService:JSONDecode(result)
    end)

    if decodeSuccess then
        scripts = decodeResult
    else
        ScriptsTab:CreateLabel("⚠️ Failed to decode Scripts.txt")
        return
    end

    if type(scripts) == "table" then
        for _, scriptData in ipairs(scripts) do
            ScriptsTab:CreateButton({
                Name = scriptData.name or "Unnamed Script",  -- match JSON lowercase
                Callback = function()
                    if scriptData.url then
                        loadstring(game:HttpGet(scriptData.url))()
                    elseif scriptData.code then
                        loadstring(scriptData.code)()
                    end
                end
            })
        end
    else
        ScriptsTab:CreateLabel("⚠️ Invalid script format")
    end
end

LoadScripts()
